<style>
.heading-section>span, h2, p, a {
	font-family: "Poppins", Arial, sans-serif;
}

.majoraddr {
	display: flex;
}

#addrshort {
	background: white;
	border: 0.05rem solid #769BCD;
	border-radius: 0.6rem;
	padding-left: 0.3rem;
	padding-right: 0.3rem;
	display: inline-block;
}

#addrshort span {
	color: #769BCD;
}

#tname h3 {
	margin-top: 0.5rem;
	margin-bottom: 0;
}

#tgymname {
	color: #343434;
	font-style: bold;
}

.btn btn-primary py-2 px-4:hover {
	background-color: white;
}
modal-body-que {
	color: black;
}
</style>

<script th:inline="javascript">

function GetTarget(j){
	var selected = $('#select_order option:selected').val();
	
	$.ajax({
		url:'/trainers/findpage',
		data:{
			'pageNo':j,
			'orderBy':selected
		},
		method:'GET',
		success: function(result){
			$('#div_trainer_row').empty();
			$('#div_trainer_row').append(result);
			
			var currentPage = j;
			var totalData = [[${totalData}]];
			var limitPerPage = [[${amount}]]; // 페이지당 데이터 수
			var pageSize = 5; // 화면에 표시될 페이지 수
			var totalPages = Math.ceil(totalData / limitPerPage);
			var pageGroup = Math.ceil(currentPage / pageSize); // 페이지 그룹
			var last = pageGroup * pageSize;
			
			if(currentPage <= 0){
				currentPage = 1;
			}
			if(last > totalPages){
				last = totalPages;
			}
			
			var first = last - (pageSize - 1);
			const next = last + 1;
			var prev = first - 1;
			
			if(totalPages < 1){
				first = last;
			}
			
			var pages = $('#pages');
			pages.empty();
			
			if(first > 1){
				pages.append('<li><a onclick="GetTarget('+ first +')">prev</a></li>');
			}
			
			for (var k = first; k <= last; k++) {
				
				if(currentPage == k){
					pages.append('<li class="active"><a onclick="GetTarget(' + k + ');"' + '>' + k + '</a></li>');
				}else if(k > 0){
					pages.append('<li><a onclick="GetTarget('+ k +')">' + k + '</a></li>');
					};
				}
			
			if(next > pageSize && next <= totalPages){
				pages.append('<li><a onclick="GetTarget(' + next + ')">next</a></li>');
			};
			
		}
		
	});
	
	history.pushState({
		data:'/trainers/findpage',
		pageNo: j
	}, // state
	null, // title
	'/trainers/list?pageNo=' + j); // url
}

	$(window).on('popstate', function(event){
		window.location = document.location.href;

	});



function paging(totalData, currentPage){
	
		/* 변수 totalData: 전체 데이터 수(Back에서 받아옴)*/
		var totalData = [[${totalData}]];
		var currentPage = [[${currentPage}]];
		var limitPerPage = [[${amount}]]; // 페이지당 데이터 수
		var pageSize = 5; // 화면에 표시될 페이지 수
		var totalPages = Math.ceil(totalData / limitPerPage);
		var pageGroup = Math.ceil(currentPage / pageSize); // 페이지 그룹
		var last = pageGroup * pageSize;
		
		if(currentPage <= 0){
			currentPage = 1;
		}
		if(last > totalPages){
			last = totalPages;
		}
		
		var first = last - (pageSize - 1);
		const next = last + 1;
		var prev = first - 1;
		
		if(totalPages < 1){
			first = last;
		}
		
		var pages = $('#pages');
		pages.empty();
		
		// prev 버튼
		if(first > 1){
			pages.append('<li><a onclick="GetTarget('+ first +')">prev</a></li>');
		}
		
		// 페이지 숫자
		for (var j = first; j <= last; j++) {
			
			if(currentPage == j){
				pages.append('<li class="active"><a onclick="GetTarget(' + j + ');"' + '>' + j + '</a></li>');
			}else if(j > 0){
				pages.append('<li><a onclick="GetTarget('+ j +')">' + j + '</a></li>');
				};
			}
		
		// next 버튼
		if(next > pageSize && next <= totalPages){
			pages.append('<li><a onclick="GetTarget(' + next + ')">next</a></li>');
		};
	
	}
	

	
	$(function(){
		paging();
		$('#select_order').change(function(){
			var cp = [[${currentPage}]];
			var ob = [[${orderBy}]];
			$('input[name="pageNo"]').val(cp);
			// $('#select_order').val(ob).prop('selected', true);
			// $('#select_order option:selected').val(ob);
			$('#form_order').attr({
				'method':'get',
				'action':'/trainers/list'
			});
			// $('#form_order').submit();
		});
	});
</script>

<section class="ftco-section">

	<div class="row justify-content-center mb-5 pb-3">
		<div class="col-md-7 heading-section text-center ftco-animate">
			<span class="subheading">Trainers</span>
			<h2 class="mb-4">트레이너</h2>
			<p>당근PT가 보증하는 현직 트레이너들!</p>
		<!-- 	<a href="#" id="btn_findmytrainer" class="btn btn-primary py-2 px-4">맞춤트레이너찾기(Click!)</a> -->
			
			<!-- Trigger the modal with a button -->
			<button type="button" class="btn btn-primary py-2 px-4"
				data-toggle="modal" data-target="#myModal">맞춤트레이너찾기(Click!)</button>
		</div>
	</div>

	<!-- Modal -->
	<div id="myModal" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">맞춤 트레이너를 찾아드려요!</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>

				</div>
				<div class="modal-body">
					<div class="modal-body-que">1. 고객님의의 성별이 어떻게 되나요?</div>
					<div>
						<label class="radio-inline"><input type="radio" id="f" name="optradio">여자</label> 
						<label class="radio-inline"><input type="radio" id="m"name="optradio">남자</label>
						<label class="radio-inline"><input type="radio" id="n"name="optradio">응답 거절</label>
					</div>

					<div class="modal-body-que">2. 고객님의 연령대는 어떻게 되나요?</div>
					<div>
						<label class="radio-inline"><input type="radio" id="10대" name="optradio" >10대</label> 
						<label class="radio-inline"><input type="radio" id="20대" name="optradio">20대</label>
						<label class="radio-inline"><input type="radio" id="30대" name="optradio">30대</label>
						<label class="radio-inline"><input type="radio" id="40대" name="optradio">40대</label>
						<label class="radio-inline"><input type="radio" id="50대" name="optradio">50대</label>
						<label class="radio-inline"><input type="radio" id="60대" name="optradio">60대 이상</label>
					</div>

					<div class="modal-body-que">3. 운동하시려는 목적을 말씀해주세요(중복체크 가능)</div>
					<div>
						<label class="checkbox-inline"><input type="checkbox" value="">다이어트</label>
						<label class="checkbox-inline"><input type="checkbox" value="">체력증진</label>
						<label class="checkbox-inline"><input type="checkbox" value="">자세교정</label>
						<label class="checkbox-inline"><input type="checkbox" value="">자격증 또는 대회</label>
					</div>

					<div class="modal-body-que">4. 평소에 운동을 얼마나 하시나요?</div>
					<div>
						<label class="radio-inline"><input type="radio" id="none" name="optradio">거의 하지 않음</label> 
						<label class="radio-inline"><input type="radio" id="onemonth" name="optradio">한 달에 1-2번</label>
						<label class="radio-inline"><input type="radio" id="oneweek" name="optradio">일주일에 1번</label>
						<label class="radio-inline"><input type="radio" id="twice" name="optradio">일주일에 2-3번</label>
						<label class="radio-inline"><input type="radio" id="four" name="optradio">일주일에 4번 이상</label>
					</div>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</div>

		</div>
	</div>




	<div class="container">
		<div class="row">
			<!-- Left Start -->
			<div class="col-lg-9 pr-lg-4">
				<div class="row" id="div_trainer_row">
					<div id="div_trainer_replace"
						th:replace="${trcenter_info} ? ${trcenter_info} : trcenter_info">
					</div>

					<!-- Single Trainer Start -->

					<!-- Single Trainer End -->
				</div>
				<!-- Page Number Start -->
				<div class="row mt-5">
					<div class="col text-center">
						<div class="block-27">
							<ul id="pages">
							</ul>
						</div>
					</div>
				</div>
				<!-- Page Number End -->
			</div>
			<!-- Left End -->
			<!-- Right Start -->

			<div class="col-lg-3 p-4 bg-light">

				<div class="search-wrap-1 ftco-animate">
					<h2 class="mb-3">Find Places</h2>
					<form action="#" class="search-property-1">
						<div class="row">
							<div class="col-lg-12 align-items-end mb-3">
								<div class="form-group">
									<label for="#">정렬</label>
									<div class="form-field">
										<div class="icon">
											<span class="ion-ios-search"></span>
										</div>
										<form id="form_order">
											<select name="orderBy" id="select_order" class="form-control">
												<option value="num desc">최신 등록순</option>
												<option>리뷰 많은순</option>
												<option value="name">이름순</option>
											</select>
											<input type="hidden" name="pageNo">
										</form>
									</div>
								</div>
							</div>
							
							<div class="col-lg-12 align-items-end mb-3">
								<div class="form-group">
									<label for="#">지역별 검색</label>
									<div class="form-field">
										<div class="icon">
											<span class="ion-ios-search"></span>
										</div>
										<form>
											<input type="text" class="form-control"
												placeholder="Search place">
										</form>
									</div>
								</div>
							</div>

							<div class="col-lg-12 align-items-end mb-3">
								<div class="form-group">
									<label for="#">운동별 검색</label>
									<div class="form-field">
										<div class="select-wrap">
											<div class="icon">
												<span class="ion-ios-arrow-down"></span>
											</div>
											<select name="" id="" class="form-control">
												<option th:each="m : ${majors}" th:value="${m.major}"></option>
											</select>
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-12 align-self-end">
								<div class="form-group">
									<div class="form-field">
										<input type="submit" value="Search"
											class="form-control btn btn-primary">
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<!-- Right End -->
		</div>
	</div>
</section>


